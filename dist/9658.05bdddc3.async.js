"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9658],{89645:function(e,t,n){n.d(t,{BU:function(){return L},O6:function(){return k},VK:function(){return K},YA:function(){return q},d:function(){return P},kR:function(){return B},n_:function(){return R},t:function(){return Z},tI:function(){return D},vF:function(){return A}});var r=n(97857),a=n.n(r),i=n(15009),u=n.n(i),o=n(99289),c=n.n(o),s=n(5574),l=n.n(s),d=n(62386),f=n(51331),p=n(4527),m=n(78551),v=n(30202),g=n(45360),h=n(62435),y=n(67421),F=n(24701),w=n(2938),b=n(96100),x=function(){var e=(0,F.lr)(),t=l()(e,1)[0].get("folderId");return null!=t?t:""},P=function(){var e,t=(0,p.D)({mutationKey:["fetchPureFileList"],gcTime:0,mutationFn:(e=c()(u()().mark((function e(t){var n,r;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Z.listFile({parent_id:t});case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})}),n=t.mutateAsync;return{loading:t.isPending,fetchList:n}},Z=function(){var e,t,n=(0,w.Qe)(),r=n.searchString,i=n.handleInputChange,o=(0,w.ye)(),s=o.pagination,l=o.setPagination,f=x(),p=(0,m.a)({queryKey:["fetchFileList",a()({id:f,searchString:r},s)],initialData:{},gcTime:0,queryFn:(t=c()(u()().mark((function e(){var t,n;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Z.listFile({parent_id:f,keywords:r,page_size:s.pageSize,page:s.current});case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}),v=p.data,g=p.isFetching,y=(0,h.useCallback)((function(e){l({page:1}),i(e)}),[i,l]);return a()(a()({},v),{},{searchString:r,handleInputChange:y,pagination:a()(a()({},s),{},{total:null==v||null===(e=v.data)||void 0===e?void 0:e.total}),setPagination:l,loading:g})},L=function(){var e,t=(0,b.fz)().setPaginationParams,n=(0,v.NL)(),r=(0,p.D)({mutationKey:["deleteFile"],mutationFn:(e=c()(u()().mark((function e(r){var a,i;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Z.removeFile(r);case 2:return a=e.sent,0===(i=a.data).code&&(t(1),n.invalidateQueries({queryKey:["fetchFileList"]})),e.abrupt("return",i.code);case 6:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})});return{data:r.data,loading:r.isPending,deleteFile:r.mutateAsync}},k=function(){var e,t=(0,p.D)({mutationKey:["downloadFile"],mutationFn:(e=c()(u()().mark((function e(t){var n,r;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Z.getFile({},t.id);case 2:n=e.sent,r=new Blob([n.data],{type:n.data.type}),(0,f.uA)(r,t.filename);case 5:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})});return{data:t.data,loading:t.isPending,downloadFile:t.mutateAsync}},A=function(){var e,t=(0,v.NL)(),n=(0,y.$G)().t,r=(0,p.D)({mutationKey:["renameFile"],mutationFn:(e=c()(u()().mark((function e(r){var a,i;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Z.renameFile(r);case 2:return a=e.sent,0===(i=a.data).code&&(g.ZP.success(n("message.renamed")),t.invalidateQueries({queryKey:["fetchFileList"]})),e.abrupt("return",i.code);case 6:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})});return{data:r.data,loading:r.isPending,renameFile:r.mutateAsync}},K=function(){var e,t=x(),n=(0,m.a)({queryKey:["fetchParentFolderList",t],initialData:[],enabled:!!t,queryFn:(e=c()(u()().mark((function e(){var n,r,a,i;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Z.getAllParentFolder({fileId:t});case 2:return a=e.sent,i=a.data,e.abrupt("return",null!==(n=null==i||null===(r=i.data)||void 0===r||null===(r=r.parent_folders)||void 0===r?void 0:r.toReversed())&&void 0!==n?n:[]);case 5:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})});return n.data},D=function(){var e,t=(0,b.fz)().setPaginationParams,n=(0,v.NL)(),r=(0,y.$G)().t,i=(0,p.D)({mutationKey:["createFolder"],mutationFn:(e=c()(u()().mark((function e(i){var o,c;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Z.createFolder(a()(a()({},i),{},{type:"folder"}));case 2:return o=e.sent,0===(c=o.data).code&&(g.ZP.success(r("message.created")),t(1),n.invalidateQueries({queryKey:["fetchFileList"]})),e.abrupt("return",c.code);case 6:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})});return{data:i.data,loading:i.isPending,createFolder:i.mutateAsync}},B=function(){var e,t=(0,b.fz)().setPaginationParams,n=(0,y.$G)().t,r=(0,v.NL)(),a=(0,p.D)({mutationKey:["uploadFile"],mutationFn:(e=c()(u()().mark((function e(a){var i,o,c,s,l;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.fileList,o=a.fileList.map((function(e){return e.webkitRelativePath})),(c=new FormData).append("parent_id",a.parentId),i.forEach((function(e,t){c.append("file",e),c.append("path",o[t])})),e.prev=5,e.next=8,d.Z.uploadFile(c);case 8:return 0===(null==(l=e.sent)?void 0:l.data.code)&&(g.ZP.success(n("message.uploaded")),t(1),r.invalidateQueries({queryKey:["fetchFileList"]})),e.abrupt("return",null==l||null===(s=l.data)||void 0===s?void 0:s.code);case 13:e.prev=13,e.t0=e.catch(5),console.log("ðŸš€ ~ useUploadFile ~ error:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[5,13]])}))),function(t){return e.apply(this,arguments)})});return{data:a.data,loading:a.isPending,uploadFile:a.mutateAsync}},R=function(){var e,t=(0,v.NL)(),n=(0,y.$G)().t,r=(0,p.D)({mutationKey:["connectFileToKnowledge"],mutationFn:(e=c()(u()().mark((function e(r){var a,i;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Z.connectFileToKnowledge(r);case 2:return a=e.sent,0===(i=a.data).code&&(g.ZP.success(n("message.operated")),t.invalidateQueries({queryKey:["fetchFileList"]})),e.abrupt("return",i.code);case 6:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})});return{data:r.data,loading:r.isPending,connectFileToKnowledge:r.mutateAsync}},q=function(){var e,t=(0,v.NL)(),n=(0,y.$G)().t,r=(0,p.D)({mutationKey:["moveFile"],mutationFn:(e=c()(u()().mark((function e(r){var a,i;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Z.moveFile(r);case 2:return a=e.sent,0===(i=a.data).code&&(g.ZP.success(n("message.operated")),t.invalidateQueries({queryKey:["fetchFileList"]})),e.abrupt("return",i.code);case 6:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})});return{data:r.data,loading:r.isPending,moveFile:r.mutateAsync}}},62386:function(e,t,n){var r=n(60806),a=n(66582),i=n(78158),u=r.Z.listFile,o=r.Z.removeFile,c=r.Z.uploadFile,s=r.Z.renameFile,l=r.Z.getAllParentFolder,d=r.Z.createFolder,f=r.Z.connectFileToKnowledge,p=r.Z.get_document_file,m=r.Z.getFile,v=r.Z.moveFile,g={listFile:{url:u,method:"get"},removeFile:{url:o,method:"post"},uploadFile:{url:c,method:"post"},renameFile:{url:s,method:"post"},getAllParentFolder:{url:l,method:"get"},createFolder:{url:d,method:"post"},connectFileToKnowledge:{url:f,method:"post"},getFile:{url:m,method:"get",responseType:"blob"},getDocumentFile:{url:p,method:"get",responseType:"blob"},moveFile:{url:v,method:"post"}},h=(0,a.Z)(g,i.ZP);t.Z=h},28382:function(e,t,n){n.d(t,{mr:function(){return u},p6:function(){return i}});var r=n(27484),a=n.n(r);function i(e){return e?a()(e).format("DD/MM/YYYY HH:mm:ss"):""}function u(e){return e?a()(e).format("HH:mm:ss"):""}},5089:function(e,t,n){n.d(t,{Ep:function(){return d},Or:function(){return f},RT:function(){return s},YC:function(){return l},q1:function(){return c}});var r=n(19632),a=n.n(r),i=n(40169),u=n(96486),o=n(57632),c=function(e,t){var n;return Array.isArray(null==e?void 0:e.positions)&&e.positions.every((function(e){return Array.isArray(e)}))?null==e||null===(n=e.positions)||void 0===n?void 0:n.map((function(n){var r={width:t.width,height:t.height,x1:n[1],x2:n[2],y1:n[3],y2:n[4]};return{id:(0,o.Z)(),comment:{text:"",emoji:""},content:{text:(0,u.get)(e,"content_with_weight")||(0,u.get)(e,"content","")},position:{boundingRect:r,rects:[r],pageNumber:n[0]}}})):[]},s=function(e){var t;return null!==(t=null==e?void 0:e.slice(e.lastIndexOf(".")+1).toLowerCase())&&void 0!==t?t:""},l=function(e){return e.split("\n").length},d=function(e){return i.ru.includes(e)},f=function(e){return[].concat(a()(i.rU),["svg"]).some((function(t){return t===e}))}},51331:function(e,t,n){n.d(t,{AG:function(){return m},De:function(){return h},P2:function(){return d},Ph:function(){return l},td:function(){return g},uA:function(){return p},vn:function(){return f}});var r=n(15009),a=n.n(r),i=n(99289),u=n.n(i),o=n(40169),c=n(62386),s=function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){var e=new Image;e.src=r.result,e.onload=function(){var n=document.createElement("canvas"),r=n.getContext("2d"),a=e.width,i=e.height,u=100;a>i&&a>u?(i=i*u/a,a=u):i>u&&(a=a*u/i,i=u),n.width=a,n.height=i,null==r||r.drawImage(e,0,0,a,i);var o=n.toDataURL("image/png");t(o)},e.onerror=n},r.onerror=n}))},l=function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},d=function(e){var t=[];return e&&(t=[{uid:"1",name:"file",thumbUrl:e,status:"done"}]),t},f=function(){var e=u()(a()().mark((function e(t){var n,r,i;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Array.isArray(t)&&t.length>0)){e.next=11;break}if(n=t[0],!(r=n.originFileObj)){e.next=10;break}return e.next=6,s(r);case 6:return i=e.sent,e.abrupt("return",i);case 10:return e.abrupt("return",n.thumbUrl);case 11:return e.abrupt("return","");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(e,t){var n=window.URL.createObjectURL(e),r=document.createElement("a");r.href=n,t&&(r.download=t),r.click(),window.URL.revokeObjectURL(n)},m=function(){var e=u()(a()().mark((function e(t){var n,r,i,u;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.filename,e.next=3,c.Z.getDocumentFile({},n);case 3:i=e.sent,u=new Blob([i.data],{type:i.data.type}),p(u,r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],g=function(e){for(var t=0,n=("string"==typeof e?parseInt(e,10):e)||0;n>=1024&&++t;)n/=1024;return n.toFixed(n<10&&t>0?1:0)+" "+v[t]},h=function(){var e=u()(a()().mark((function e(t,n){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new Blob([JSON.stringify(t)],{type:o.nK.Json}),p(r,n);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=9658.05bdddc3.async.js.map